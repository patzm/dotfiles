# Load Znap
source ~/.zsh/znap/znap.zsh

# vim mode configuration
bindkey -v
export KEYTIMEOUT=1

# Plugins
znap source marlonrichert/zsh-autocomplete
znap source zsh-users/zsh-syntax-highlighting
znap source jocelynmallon/zshmarks
znap source ohmyzsh/ohmyzsh plugins/git

# Aliases
source ${ZDOTDIR}/zshalias.sh

# Functions
source ${ZDOTDIR}/zshfunctions.sh

# command history configuration
HISTFILE=${XDG_CACHE_HOME}/zsh_history
HISTSIZE=10000
SAVEHIST=10000
setopt appendhistory

# Configure zsh-autocomplete behavior
zstyle ':autocomplete:*complete*:*' insert-unambiguous yes
bindkey '^I' menu-select
bindkey "$terminfo[kcbt]" menu-select

# enable editing the current command in the default editor
autoload -z edit-command-line
zle -N edit-command-line
bindkey "^X^E" edit-command-line

# PATH modificiation
typeset -U path
path+=(
	"${HOME}/.local/bin"
)

{{ if eq .chezmoi.os "darwin" -}}
# start - macOS specific

# Disable compfix checking for multi-user setup
ZSH_DISABLE_COMPFIX=true

# Add the correct HomeBrew folder to the PATH
if [ "$(sysctl -in sysctl.proc_translated)" = "0" ]; then
    path+=("/opt/homebrew/bin" "/opt/homebrew/sbin")
else
    path+=("/usr/local/bin" "/usr/local/sbin")
fi

# Add all local HomeBrew install folders of Python to the PATH
for python_dir in $(brew --prefix)/opt/python@*; do
    path+=("${python_dir}/bin")
done

# Add custom plugins
znap source ohmyzsh/ohmyzsh plugins/brew

alias brew-update='brew update && brew upgrade && brew cleanup'

# Launch commands
alias only-office='open -na "OnlyOffice"'

# end - macOS specific
{{- end }}

# Load the instance-specific configuration
source ${ZDOTDIR}/zshinstance.sh

# Load the fzf configuration
source ${ZDOTDIR}/fzfrc.sh

# Python autoswitch
znap source MichaelAquilina/zsh-autoswitch-virtualenv

# Accelerate start time
znap eval starship 'starship init zsh --print-full-init'
znap prompt

export PATH
# vim: set filetype=zsh : 
